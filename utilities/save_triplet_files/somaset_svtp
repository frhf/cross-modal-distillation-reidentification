import glob
import os
import random

class Person:
    def __init__(self, first, path):

        self.paths = glob.glob(path+"/*/*")
        self.first = first
        self.last = first + len(self.paths) - 1

# load all persons
paths_pers = glob.glob("//media/fhafner/Windows/Datasets/SOMAset/somaset/*")
paths_pers.sort()
persons = []
first = 0

for i, path in enumerate(paths_pers):

    pers = Person(first, path)
    persons.append(pers)
    first = pers.last + 1



paths = glob.glob("//media/fhafner/Windows/Datasets/SOMAset/somaset/*/*/*")
paths.sort()

if not os.path.isfile("./somaset_paths.txt"):
    path_file = open("somaset_paths.txt", "w")
    for p in paths:
        path_file.write(p)
        path_file.write("\n")
    path_file.close()


trip = open("somaset_triplets.txt","w")
for i in range(500000):
    pos = int(random.random()*50)
    neg = int(random.random()*50)
    while neg == pos:
        neg = int(random.random() * 50)

    anch = persons[pos].first + int(random.random()*len(persons[pos].paths))
    posi = persons[pos].first + int(random.random()*len(persons[pos].paths))
    nega = persons[neg].first + int(random.random()*len(persons[neg].paths))

    trip.write(str(anch) + " " + str(nega) + " " + str(posi) + "\n")
